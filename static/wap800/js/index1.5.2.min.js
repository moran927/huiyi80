$(function ()
{
    $("#loadMore").click(function ()
    {
        if ($(this).hasClass("loading"))
        {
            return false;
        }
        var c = parseInt($(this).attr("data-page")),
        e = $(this),
        b = FTXIA.ajax;
        $.ajax(
        {
            type : "get",
            url : b,
            data :
            {
                page : c + 1
            },
            dataType : "json",
            beforeSend : function (g)
            {
                e.addClass("loading");
                e.html("加载中...");
            },
            success : function (o)
            {
                var r = o.data.toString();
                $(".deals aside.more").before(r);
                e.attr("data-page", (c + 1));
                if (o.msg<20)
                {
                    e.html("已经到最后了");
                    e.addClass("endload");
                    return false;
                }
                e.removeClass("loading");
                e.html("点击加载更多");
                window.myScroll && myScroll.scroller.refresh();
            },
            error : function (g, i, h)
            {
                alert(h);
            }
        }
        );
    }
    );


    $(".dropdown-trigger").bind("click", function (d)
    {
        d.preventDefault();
        d.stopPropagation();
        var c = $(this),
        f = c.next(".dropdown-menu"),
        b = c.find(".icon-arrow"),
        a = f.hasClass("active");
        if (a)
        {
            f.removeClass("active");
            b.removeClass("up").addClass("down");
        }
        else
        {
            f.addClass("active");
            b.removeClass("down").addClass("up");
        }

    }
    );
    $(document).click(function ()
    {
        if ($(".dropdown-menu").hasClass("active"))
        {
            $(".dropdown-menu").removeClass("active");
            $(".dropdown-trigger").find(".icon-arrow").removeClass("up").addClass("down");
        }
    }
    );

    // $(".deals div h2 sub").live("click", function (b)
    // {
    //     if ($.cookie("wap_ppinf") == "" || $.cookie("wap_ppinf") == null)
    //     {
    //         window.location = "http://m.zhe800.com/login?return_to=" + window.location.href;
    //         return false;
    //     }
    //     var a = $(this);
    //     if (!a.hasClass("check"))
    //     {
    //         $.post("http://m.zhe800.com/profile/my_favorites/" + a.parents("div").data("id") + "/create", function (c, e, d)
    //         {
    //             if (parseInt(c.status) < 300)
    //             {
    //                 a.addClass("check");
    //             }
    //             else
    //             {
    //                 alert(c.message);
    //             }
    //         }
    //         );
    //     }
    //     else
    //     {
    //         $.post("http://m.zhe800.com/profile/my_favorites/" + a.parents("div").data("id") + "/delete", function (c, e, d)
    //         {
    //             if (parseInt(c.status) < 300)
    //             {
    //                 a.removeClass("check");
    //             }
    //             else
    //             {
    //                 alert(c.message);
    //             }
    //         }
    //         );
    //     }
    // }
    // );
}
);
(function (a)
{
    a.fn.carousel = function (g)
    {
        var h = a.extend(
            {
                auto : true
            }, g),
        d = this,
        o = d.find(".carousel-inner"),
        k = d.find(".carousel-indicators"),
        j = null,
        b = o.find(".item"),
        c = b.outerWidth(true),
        s = b.length,
        m = 0,
        r = swipe = false,
        f = null,
        e = null,
        u = "ontouchstart" in window,
        i =
        {
            start : u ? "touchstart" : "mousedown",
            move : u ? "touchmove" : "mousemove",
            end : u ? "touchend" : "mouseup"
        },
        t =
        {
            start :
            {
                x : 0,
                y : 0
            },
            obj :
            {
                x : 0,
                y : 0
            },
            end :
            {
                x : 0,
                y : 0
            }
        };
        p();
        o.get(0).addEventListener(i.start, function (w)
        {
            e = new Date();
            clearInterval(f);
            if (r)
            {
                return;
            }
            swipe = false;
            var n = y = 0;
            r = true;
            o.addClass("moving");
            if (w.touches && w.touches.length)
            {
                n = w.touches[0].pageX;
                y = w.touches[0].pageY;
            }
            else
            {
                n = w.pageX;
                y = w.pageY;
            }
            o.removeClass("flow");
            t.start =
            {
                x : n,
                y : y
            };
            document.addEventListener(i.move, l, false);
        }, false);
        o.bind("click", function (n)
        {
            swipe && n.preventDefault();
        }
        );
        document.addEventListener(i.end, function (A)
        {
            if (!r)
            {
                return;
            }
            var z = t.obj.x,
            n = z % c,
            x = -Math.floor(z / c),
            w = new Date();
            if (w - e > 300)
            {
                swipe = true;
            }
            o.removeClass("moving");
            o.addClass("flow");
            if (n)
            {
                if (Math.abs(n) < c / 2)
                {
                    x--;
                }
            }
            t.end.x = v(x);
            document.removeEventListener(i.move, l, false);
            r = false;
            if (h.auto)
            {
                f = setInterval(q, 3000);
            }
        }, false);
        function l(A)
        {
            A.preventDefault();
            var n = y = 0;
            if (A.touches && A.touches.length)
            {
                n = A.touches[0].pageX;
                y = A.touches[0].pageY;
            }
            else
            {
                n = A.pageX;
                y = A.pageY;
            }
            var z = n - t.start.x,
            w = y - t.start.y;
            t.obj.x = t.end.x + z;
            o.css("webkitTransform", "translate(" + t.obj.x + "px,0)");
        }
        function v(w)
        {
            if (w >= s)
            {
                var n = w % s,
                A = -n * c;
                setTimeout(function ()
                {
                    var B = o.hasClass("flow");
                    B && o.removeClass("flow");
                    t.obj.x = v(n);
                    B || o.removeClass("flow");
                }, 300);
            }
            m = w >= s ? s : w < 0 ? 0 : w;
            var x = -m * c,
            z = j.eq(m);
            z.hasClass("active") || z.addClass("active").siblings().removeClass("active");
            o.css("webkitTransform", "translate(" + x + "px,0)");
            t.end.x = x;
            return x;
        }
        function q()
        {
            o.hasClass("flow") || o.addClass("flow");
            v(++m);
        }
        function p()
        {
            var n = "";
            b.clone().appendTo(o);
            o.width(c * s * 2);
            for (var w = 0; w < s; w++)
            {
                n += "<li></li>";
            }
            k.html(n);
            j = k.find("li");
            j.eq(0).addClass("active");
            if (h.auto)
            {
                f = setInterval(q, 3000);
            }
        }
    };
    a(document).ready(function ()
    {
        var c = a(".carousel"),
        b = c.find("img").eq(0);
        if (b[0] && b[0].complete)
        {
            c.carousel();
        }
        else
        {
            b.bind("load", function ()
            {
                c.carousel();
            }
            );
        }
    }
    );
}
)(jQuery);
(function (a)
{
    a(document).ready(function ()
    {
        var c =
        {
            create : function (f, g)
            {
                var i = a.extend({}, g),
                h = this,
                j = a(this.tpl[f]);
                j.appendTo(a("body"));
                if (/ipod|ipad|iphone/i.test(navigator.userAgent))
                {
                    j.css("cursor", "pointer");
                }
                j.delegate(".btn-close", "click", function (k)
                {
                    k.preventDefault();
                    j.remove();
                    if (f != "bar" && location.pathname == "/")
                    {
                        localStorage.getItem("download") || h.create("bar");
                    }
                }
                );
                j.hasClass("pop-bar") && j.delegate(".dl-trigger,.btn-close", "click", function (k)
                {
                    if (!localStorage.getItem("download"))
                    {
                        localStorage.setItem("download", "yes");
                    }
                }
                );
                j.hasClass("pop-shortcut") && j.delegate(".btn-close", "click", function (k)
                {
                    if (!localStorage.getItem("shortcut"))
                    {
                        localStorage.setItem("shortcut", "closed");
                    }
                }
                );
                a.type(i.openfun) == "function" && i.openfun.call(j);
                return j;
            },
            tpl :
            {
                //bar : '<div class="pop-bar stick"> <p><a href="/download' + (/homepage\/?$/.test(location.pathname) ? "?source=sns" : "") + '" class="btn dl-trigger">立即下载</a><a href="" class="btn-close empty"></a></p> <i class="icon-logo"></i><span>便宜一样有好货！<br /> 淘宝天猫折扣特卖</span> </div>',
                shortcut : '<div class="pop-shortcut stick"> <i class="icon-arrow down"></i> <a href="" class="btn-close"></a> <div class="con"> <p>亲，把我添加到手机屏幕上吧！</p> <p class="">点击下方按钮后，选择“添加到主屏”</p> </div> </div>',
                bookMark : '<div class="pop-shortcut stick"> <i class="icon-arrow down"></i> <a href="" class="btn-close"></a> <div class="con"> <p>亲，把我添加到书签里吧！</p></div> </div>'
            },
            browser : function (h)
            {
                var g = a.type(h),
                f = navigator.userAgent;
                if (g == "regexp")
                {
                    return h.test(f);
                }
                else
                {
                    if (g == "string")
                    {
                        return new RegExp(h).test(f);
                    }
                }
            },
            version : function ()
            {
                var h = navigator.userAgent;
                if (/ipod|iphone|ipad/i.test(h) && /AppleWebKit/i.test(h))
                {
                    var g = /os\s?(\d\_\d)/i.exec(h),
                    f = g[1] ? g[1].replace(/\_/g, ".") * 1 : null;
                    return f;
                }
                else
                {
                    if (/android/i.test(h))
                    {
                        var g = /android\s?(\d\W\d)/i.exec(h),
                        f = g[1] ? parseFloat(g[1]) : null;
                        return f;
                    }
                }
            }
        },
        e = null,
        d = a("body"),
        b = false;
        if (location.pathname != "/")
        {
            return;
        }
        if (window.localStorage)
        {
            if (localStorage.getItem("visited"))
            {
                b = true;
            }
            else
            {
                localStorage.setItem("visited", "yes");
            }
        }
        if (c.browser(/ipod|iphone|ipad/i) && c.browser(/AppleWebKit/i))
        {
            if (navigator.standalone === false && !localStorage.getItem("shortcut"))
            {
                e = c.create("shortcut");
            }
            else
            {
                if (!localStorage.getItem("download") && location.pathname == "/")
                {
                    e = c.create("bar");
                }
            }
        }
        else
        {
            if (c.browser(/android/i))
            {
                if (!b)
                {
                    if (c.browser(/360browser|baidubrowser|ucbrowser|MiuiBrowser/i))
                    {
                        e = c.create("bookMark",
                            {
                                openfun : function ()
                                {
                                    var f = this;
                                    f.find(".icon-arrow").removeClass("down").addClass("up");
                                    f.addClass("upon");
                                    if (c.browser(/MiuiBrowser/i))
                                    {
                                        f.find(".con").html("亲，把我添加到手机屏幕上吧！<br />点击按钮后，选择“发送桌面“");
                                    }
                                }
                            }
                            );
                    }
                    else
                    {
                        e = c.create("bookMark");
                    }
                }
                else
                {
                    if (!localStorage.getItem("download") && location.pathname == "/")
                    {
                        e = c.create("bar");
                    }
                }
            }
            else
            {
                if (!b)
                {
                    e = c.create("bookMark");
                }
                else
                {
                    if (!localStorage.getItem("download") && location.pathname == "/")
                    {
                        e = c.create("bar");
                    }
                }
            }
        }
        window.myScroll =
        {
            init : function (f, h)
            {
                var g = this;
                if (!this.scroller)
                {
                    a("body").addClass("noscroll");
                    this.scroller = new IScroll(f, h);
                    a("#toTop").unbind().click(function ()
                    {
                        g.scroller.scrollTo(0, 0, 300);
                    }
                    );
                }
                return this.scroller;
            },
            destroy : function ()
            {
                if (this.scroller)
                {
                    var f = this.scroller;
                    this.scroller = null;
                    a("body").removeClass("noscroll");
                    f.destroy();
                }
            },
            scroller : null,
        };
        if (e)
        {
            if ((c.browser(/ipod|iphone|ipad/i) && c.browser(/AppleWebKit/i) && c.version() >= 6) || (c.browser(/android/i) && c.version() >= 4 && !c.browser(/SAMSUNG/i)))
            {
                a("<style>.stick{position:fixed}</style>").appendTo(a("head"));
            }
            else
            {
                myScroll.init("#wrapper",
                {
                    click : c.browser(/ipod|iphone|ipad/i),
                    zoom : false
                }
                );
                document.addEventListener("touchmove", function (f)
                {
                    f.preventDefault();
                }, false);
                window.addEventListener("load", function ()
                {
                    myScroll.scroller.refresh();
                }, false);
            }
        }
    }
    );
}
)(jQuery);

(function ($){
  $('#myform').live('submit',function(){
      var s = $('input[name="k"]').attr('value');
      if(s==''||s=='搜一下吧'){
        alert('请输入关键词');
        return false;
      }    
  });

})(jQuery);
function transdate(a)
{
    var b = new Date();
    b.setFullYear(a.substring(0, 4));
    b.setMonth(a.substring(5, 7) - 1);
    b.setDate(a.substring(8, 10));
    b.setHours(a.substring(11, 13));
    b.setMinutes(a.substring(14, 16));
    b.setSeconds(a.substring(17, 19));
    return Date.parse(b);
}
